"""
WHO Child Growth Standards LMS Parameters (0-24 months)
Source: CDC/WHO Growth Charts Data Files
https://www.cdc.gov/growthcharts/who-data-files.htm

LMS Method: L (Box-Cox power), M (median), S (coefficient of variation)
"""

# Weight-for-age LMS parameters (kg)
WEIGHT_FOR_AGE_BOYS = {
    0: {"L": 0.3487, "M": 3.3464, "S": 0.14602},
    1: {"L": 0.2297, "M": 4.4709, "S": 0.13395},
    2: {"L": 0.197, "M": 5.5675, "S": 0.12385},
    3: {"L": 0.1738, "M": 6.3762, "S": 0.11727},
    4: {"L": 0.1553, "M": 7.0023, "S": 0.11316},
    5: {"L": 0.1395, "M": 7.5105, "S": 0.1108},
    6: {"L": 0.1257, "M": 7.934, "S": 0.10958},
    7: {"L": 0.1134, "M": 8.297, "S": 0.10902},
    8: {"L": 0.1021, "M": 8.6151, "S": 0.10882},
    9: {"L": 0.0917, "M": 8.9014, "S": 0.10881},
    10: {"L": 0.082, "M": 9.1649, "S": 0.10891},
    11: {"L": 0.073, "M": 9.4122, "S": 0.10906},
    12: {"L": 0.0644, "M": 9.6479, "S": 0.10925},
    13: {"L": 0.0563, "M": 9.8749, "S": 0.10949},
    14: {"L": 0.0487, "M": 10.0953, "S": 0.10976},
    15: {"L": 0.0413, "M": 10.3108, "S": 0.11007},
    16: {"L": 0.0343, "M": 10.5228, "S": 0.11041},
    17: {"L": 0.0275, "M": 10.7319, "S": 0.11079},
    18: {"L": 0.0211, "M": 10.9385, "S": 0.11119},
    19: {"L": 0.0148, "M": 11.143, "S": 0.11164},
    20: {"L": 0.0087, "M": 11.3462, "S": 0.11211},
    21: {"L": 0.0029, "M": 11.5486, "S": 0.11261},
    22: {"L": -0.0028, "M": 11.7504, "S": 0.11314},
    23: {"L": -0.0083, "M": 11.9514, "S": 0.11369},
    24: {"L": -0.0137, "M": 12.1515, "S": 0.11426},
}

WEIGHT_FOR_AGE_GIRLS = {
    0: {"L": 0.3809, "M": 3.2322, "S": 0.14171},
    1: {"L": 0.1714, "M": 4.1873, "S": 0.13724},
    2: {"L": 0.0962, "M": 5.1282, "S": 0.13},
    3: {"L": 0.0402, "M": 5.8458, "S": 0.12619},
    4: {"L": -0.005, "M": 6.4237, "S": 0.12402},
    5: {"L": -0.043, "M": 6.8985, "S": 0.12274},
    6: {"L": -0.0756, "M": 7.297, "S": 0.12204},
    7: {"L": -0.1039, "M": 7.6422, "S": 0.12178},
    8: {"L": -0.1288, "M": 7.9487, "S": 0.12181},
    9: {"L": -0.1507, "M": 8.2254, "S": 0.12199},
    10: {"L": -0.17, "M": 8.48, "S": 0.12223},
    11: {"L": -0.1872, "M": 8.7192, "S": 0.12247},
    12: {"L": -0.2024, "M": 8.9481, "S": 0.12268},
    13: {"L": -0.2158, "M": 9.1699, "S": 0.12283},
    14: {"L": -0.2278, "M": 9.387, "S": 0.12294},
    15: {"L": -0.2384, "M": 9.6008, "S": 0.12299},
    16: {"L": -0.2478, "M": 9.8124, "S": 0.12303},
    17: {"L": -0.2562, "M": 10.0226, "S": 0.12306},
    18: {"L": -0.2637, "M": 10.2315, "S": 0.12309},
    19: {"L": -0.2703, "M": 10.4393, "S": 0.12315},
    20: {"L": -0.2762, "M": 10.6464, "S": 0.12323},
    21: {"L": -0.2815, "M": 10.8534, "S": 0.12335},
    22: {"L": -0.2862, "M": 11.0608, "S": 0.1235},
    23: {"L": -0.2903, "M": 11.2688, "S": 0.12369},
    24: {"L": -0.2941, "M": 11.4775, "S": 0.1239},
}

# Length-for-age LMS parameters (cm)
LENGTH_FOR_AGE_BOYS = {
    0: {"L": 1, "M": 49.8842, "S": 0.03795},
    1: {"L": 1, "M": 54.7244, "S": 0.03557},
    2: {"L": 1, "M": 58.4249, "S": 0.03424},
    3: {"L": 1, "M": 61.4292, "S": 0.03328},
    4: {"L": 1, "M": 63.886, "S": 0.03257},
    5: {"L": 1, "M": 65.9026, "S": 0.03204},
    6: {"L": 1, "M": 67.6236, "S": 0.03165},
    7: {"L": 1, "M": 69.1645, "S": 0.03139},
    8: {"L": 1, "M": 70.5994, "S": 0.03124},
    9: {"L": 1, "M": 71.9687, "S": 0.03117},
    10: {"L": 1, "M": 73.2812, "S": 0.03118},
    11: {"L": 1, "M": 74.5388, "S": 0.03125},
    12: {"L": 1, "M": 75.7488, "S": 0.03137},
    13: {"L": 1, "M": 76.9186, "S": 0.03154},
    14: {"L": 1, "M": 78.0497, "S": 0.03174},
    15: {"L": 1, "M": 79.1458, "S": 0.03197},
    16: {"L": 1, "M": 80.2113, "S": 0.03222},
    17: {"L": 1, "M": 81.2487, "S": 0.0325},
    18: {"L": 1, "M": 82.2587, "S": 0.03279},
    19: {"L": 1, "M": 83.2418, "S": 0.0331},
    20: {"L": 1, "M": 84.1996, "S": 0.03342},
    21: {"L": 1, "M": 85.1348, "S": 0.03376},
    22: {"L": 1, "M": 86.0477, "S": 0.0341},
    23: {"L": 1, "M": 86.941, "S": 0.03445},
    24: {"L": 1, "M": 87.8161, "S": 0.03479},
}

LENGTH_FOR_AGE_GIRLS = {
    0: {"L": 1, "M": 49.1477, "S": 0.0379},
    1: {"L": 1, "M": 53.6872, "S": 0.0364},
    2: {"L": 1, "M": 57.0673, "S": 0.03568},
    3: {"L": 1, "M": 59.8029, "S": 0.0352},
    4: {"L": 1, "M": 62.0899, "S": 0.03486},
    5: {"L": 1, "M": 64.0301, "S": 0.03463},
    6: {"L": 1, "M": 65.7311, "S": 0.03448},
    7: {"L": 1, "M": 67.2873, "S": 0.03441},
    8: {"L": 1, "M": 68.7498, "S": 0.0344},
    9: {"L": 1, "M": 70.1435, "S": 0.03444},
    10: {"L": 1, "M": 71.4818, "S": 0.03452},
    11: {"L": 1, "M": 72.771, "S": 0.03464},
    12: {"L": 1, "M": 74.015, "S": 0.03479},
    13: {"L": 1, "M": 75.2176, "S": 0.03496},
    14: {"L": 1, "M": 76.3817, "S": 0.03514},
    15: {"L": 1, "M": 77.5099, "S": 0.03534},
    16: {"L": 1, "M": 78.6055, "S": 0.03555},
    17: {"L": 1, "M": 79.671, "S": 0.03576},
    18: {"L": 1, "M": 80.7079, "S": 0.03598},
    19: {"L": 1, "M": 81.7182, "S": 0.0362},
    20: {"L": 1, "M": 82.7036, "S": 0.03643},
    21: {"L": 1, "M": 83.6654, "S": 0.03666},
    22: {"L": 1, "M": 84.604, "S": 0.03688},
    23: {"L": 1, "M": 85.5202, "S": 0.03711},
    24: {"L": 1, "M": 86.4153, "S": 0.03734},
}


def get_lms_data(measurement_type: str, sex: str, age_months: int) -> dict:
    """Get LMS parameters for a given measurement type, sex, and age."""
    if measurement_type == "weight":
        data = WEIGHT_FOR_AGE_BOYS if sex == "male" else WEIGHT_FOR_AGE_GIRLS
    else:  # length
        data = LENGTH_FOR_AGE_BOYS if sex == "male" else LENGTH_FOR_AGE_GIRLS

    return data.get(age_months)
